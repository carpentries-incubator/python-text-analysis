<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Text Analysis in Python: Preparing and Preprocessing Your Data</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/cp/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/cp/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/cp/favicon-16x16.png"><link rel="manifest" href="../favicons/cp/site.webmanifest"><link rel="mask-icon" href="../favicons/cp/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav carpentries"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="cp-logo" alt="Lesson Description" src="../assets/images/carpentries-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../03-preprocessing.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav carpentries" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="../assets/images/carpentries-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Text Analysis in Python
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Text Analysis in Python
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Text Analysis in Python
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 10%" class="percentage">
    10%
  </div>
  <div class="progress carpentries">
    <div class="progress-bar carpentries" role="progressbar" style="width: 10%" aria-valuenow="10" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../03-preprocessing.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-basicConcepts.html">1. Introduction to Natural Language Processing</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-apis.html">2. Corpus Development- Text Data Collection</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3. Preparing and Preprocessing Your Data
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#preparing-and-preprocessing-your-data">Preparing and Preprocessing Your Data</a></li>
<li><a href="#collection">Collection</a></li>
<li><a href="#loading-data-into-python">Loading Data into Python</a></li>
<li><a href="#preprocessing">Preprocessing</a></li>
<li><a href="#putting-it-all-together">Putting it All Together</a></li>
<li><a href="#saving-our-progress">Saving Our Progress</a></li>
<li><a href="#outro-and-conclusion">Outro and Conclusion</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-vectorSpace.html">4. Vector Space and Distance</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-tf-idf-documentEmbeddings.html">5. Document Embeddings and TF-IDF</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-lsa.html">6. Latent Semantic Analysis</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-wordEmbed_intro.html">7. Intro to Word Embeddings</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-wordEmbed_word2vec-algorithm.html">8. The Word2Vec Algorithm</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-wordEmbed_train-word2vec.html">9. Training Word2Vec</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-finetuning-transformers.html">10. Finetuning LLMs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-ethics.html">11. Ethics and Text Analysis</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-apis.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-vectorSpace.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-apis.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Corpus Development-
        </a>
        <a class="chapter-link float-end" href="../instructor/04-vectorSpace.html" rel="next">
          Next: Vector Space and...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Preparing and Preprocessing Your Data</h1>
        <p>Last updated on 2025-03-21 |

        <a href="https://github.com/josenino95/python-text-analysis/edit/main/episodes/03-preprocessing.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can I prepare data for NLP?</li>
<li>What are tokenization, casing and lemmatization?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Load a test document into Spacy.</li>
<li>Learn preprocessing tasks.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="preparing-and-preprocessing-your-data">Preparing and Preprocessing Your Data<a class="anchor" aria-label="anchor" href="#preparing-and-preprocessing-your-data"></a></h2>
<hr class="half-width"></section><section><h2 class="section-heading" id="collection">Collection<a class="anchor" aria-label="anchor" href="#collection"></a></h2>
<hr class="half-width"><p>The first step to preparing your data is to collect it. Whether you
use API’s to gather your material or some other method depends on your
research interests. For this workshop, we’ll use pre-gathered data.</p>
<p>During the setup instructions, we asked you to download a number of
files. These included about forty texts downloaded from <a href="https://www.gutenberg.org/" class="external-link">Project Gutenberg</a>, which will make
up our corpus of texts for our hands on lessons in this course.</p>
<p>Take a moment to orient and familiarize yourself with them:</p>
<ul><li>Austen
<ul><li>Emma - <a href="https://gutenberg.org/ebooks/158#bibrec" class="external-link">record</a>
· <a href="https://en.wikipedia.org/wiki/Emma_(novel)" class="external-link">wiki</a>
</li>
<li>Lady Susan - <a href="https://gutenberg.org/ebooks/946#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Lady_Susan" class="external-link">wiki</a>
</li>
<li>Northanger Abbey - <a href="https://gutenberg.org/ebooks/121#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Northanger_Abbey" class="external-link">wiki</a>
</li>
<li>Persuasion - <a href="https://www.gutenberg.org/ebooks/105#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Persuasion_(novel)" class="external-link">wiki</a>
</li>
<li>Pride and Prejudice - <a href="https://gutenberg.org/ebooks/1342#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Pride_and_Prejudice" class="external-link">wiki</a>
</li>
<li>Sense and Sensibility - <a href="https://gutenberg.org/ebooks/21839#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Sense_and_Sensibility" class="external-link">wiki</a>
</li>
</ul></li>
<li>Chesteron
<ul><li>The Ball and the Cross - <a href="https://gutenberg.org/ebooks/5265#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Ball_and_the_Cross" class="external-link">wiki</a>
</li>
<li>The Innocence of Father Brown - <a href="https://gutenberg.org/ebooks/204#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Father_Brown" class="external-link">wiki</a>
</li>
<li>The Man Who Knew Too Much - <a href="https://gutenberg.org/ebooks/1720#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Man_Who_Knew_Too_Much_(book)" class="external-link">wiki</a>
</li>
<li>The Napoleon of Notting Hill - <a href="https://gutenberg.org/ebooks/20058#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Napoleon_of_Notting_Hill" class="external-link">wiki</a>
</li>
<li>The Man Who was Thursday - <a href="https://gutenberg.org/ebooks/1695#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Man_Who_Was_Thursday" class="external-link">wiki</a>
</li>
<li>The Ballad of the White Horse - <a href="https://gutenberg.org/ebooks/1719#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Ballad_of_the_White_Horse" class="external-link">wiki</a>
</li>
</ul></li>
<li>Dickens
<ul><li>Bleak House - <a href="https://www.gutenberg.org/ebooks/1023#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Bleak_House" class="external-link">wiki</a>
</li>
<li>A Christmas Carol - <a href="https://gutenberg.org/ebooks/24022#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/A_Christmas_Carol" class="external-link">wiki</a>
</li>
<li>David Copperfield - <a href="https://gutenberg.org/ebooks/766#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/David_Copperfield" class="external-link">wiki</a>
</li>
<li>Great Expectations - <a href="https://gutenberg.org/ebooks/1400#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Great_Expectations" class="external-link">wiki</a>
</li>
<li>Hard Times - <a href="https://gutenberg.org/ebooks/786#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Hard_Times_(novel)" class="external-link">wiki</a>
</li>
<li>Oliver Twist - <a href="https://gutenberg.org/ebooks/730#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Oliver_Twist" class="external-link">wiki</a>
</li>
<li>Our Mutual Friend - <a href="https://gutenberg.org/ebooks/883#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Our_Mutual_Friend" class="external-link">wiki</a>
</li>
<li>The Pickwick Papers - <a href="https://gutenberg.org/ebooks/580#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Pickwick_Papers" class="external-link">wiki</a>
</li>
<li>A Tale of Two Cities - <a href="https://gutenberg.org/ebooks/98#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/A_Tale_of_Two_Cities" class="external-link">wiki</a>
</li>
</ul></li>
<li>Dumas
<ul><li>The Black Tulip - <a href="https://gutenberg.org/ebooks/965#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Black_Tulip" class="external-link">wiki</a>
</li>
<li>The Man in the Iron Mask - <a href="https://gutenberg.org/ebooks/2759#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Vicomte_of_Bragelonne:_Ten_Years_Later#Part_Three:_The_Man_in_the_Iron_Mask_(Chapters_181%E2%80%93269)" class="external-link">wiki</a>
</li>
<li>The Count of Monte Cristo - <a href="https://www.gutenberg.org/ebooks/1184#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Count_of_Monte_Cristo" class="external-link">wiki</a>
</li>
<li>Ten Years Later - <a href="https://gutenberg.org/ebooks/2681#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Vicomte_of_Bragelonne:_Ten_Years_Later" class="external-link">wiki</a>
</li>
<li>The Three Musketeers - <a href="https://gutenberg.org/ebooks/1257#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Three_Musketeers" class="external-link">wiki</a>
</li>
<li>Twenty Years After - <a href="https://gutenberg.org/ebooks/1259#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Twenty_Years_After" class="external-link">wiki</a>
</li>
</ul></li>
<li>Melville
<ul><li>Bartleby, the Scrivener - <a href="https://gutenberg.org/ebooks/11231#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Bartleby,_the_Scrivener" class="external-link">wiki</a>
</li>
<li>The Confidence-Man - <a href="https://www.gutenberg.org/ebooks/21816" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Confidence-Man" class="external-link">wiki</a>
</li>
<li>Moby Dick - <a href="https://gutenberg.org/ebooks/2701#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Moby-Dick" class="external-link">wiki</a>
</li>
<li>Omoo - <a href="https://gutenberg.org/ebooks/4045#bibrec" class="external-link">record</a>
· <a href="https://en.wikipedia.org/wiki/Omoo" class="external-link">wiki</a>
</li>
<li>The Piazza Tales - <a href="https://gutenberg.org/ebooks/15859#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/The_Piazza_Tales" class="external-link">wiki</a>
</li>
<li>Pierre - <a href="https://gutenberg.org/ebooks/34970#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Pierre;_or,_The_Ambiguities" class="external-link">wiki</a>
</li>
<li>Typee - <a href="https://gutenberg.org/ebooks/1900#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Typee" class="external-link">wiki</a>
</li>
</ul></li>
<li>Shakespeare
<ul><li>The Trajedy of Julius Caesar - <a href="https://gutenberg.org/ebooks/1120#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Julius_Caesar_(play)" class="external-link">wiki</a>
</li>
<li>The Trajedy of King Lear - <a href="https://gutenberg.org/ebooks/1532#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/King_Lear" class="external-link">wiki</a>
</li>
<li>A Midsummer Night’s Dream - <a href="https://gutenberg.org/ebooks/1514#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/A_Midsummer_Night%27s_Dream" class="external-link">wiki</a>
</li>
<li>Much Ado about Nothing - <a href="https://gutenberg.org/ebooks/1519#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Much_Ado_About_Nothing" class="external-link">wiki</a>
</li>
<li>Othello, the Moor of Venice - <a href="https://www.gutenberg.org/ebooks/1531" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Othello" class="external-link">wiki</a>
</li>
<li>Romeo and Juliet - <a href="https://gutenberg.org/ebooks/1513#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Romeo_and_Juliet" class="external-link">wiki</a>
</li>
<li>Twelfth Night - <a href="https://gutenberg.org/ebooks/1526#bibrec" class="external-link">record</a> · <a href="https://en.wikipedia.org/wiki/Twelfth_Night" class="external-link">wiki</a>
</li>
</ul></li>
</ul><p>While a full-sized corpus can include thousands of texts, these
forty-odd texts will be enough for our illustrative purposes.</p>
</section><section><h2 class="section-heading" id="loading-data-into-python">Loading Data into Python<a class="anchor" aria-label="anchor" href="#loading-data-into-python"></a></h2>
<hr class="half-width"><p>We’ll start by mounting our Google Drive so that Colab can read the
helper functions. We’ll also go through how many of these functions are
written in this lesson.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Run this cell to mount your Google Drive.</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>drive.mount(<span class="st">'/content/drive'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># Show existing colab notebooks and helpers.py file</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="im">from</span> os <span class="im">import</span> listdir</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>wksp_dir <span class="op">=</span> <span class="st">'/content/drive/My Drive/Colab Notebooks/text-analysis'</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>listdir(wksp_dir)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Add folder to colab's path so we can import the helper functions</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>sys.path.insert(<span class="dv">0</span>, wksp_dir)</span></code></pre>
</div>
<p>Next, we have a corpus of text files we want to analyze. Let’s create
a method to list those files. To make this method more flexible, we will
also use <code>glob</code> to allow us to put in regular expressions so
we can filter the files if so desired. <code>glob</code> is a tool for
listing files in a directory whose file names match some pattern, like
all files ending in <code>*.txt</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="op">!</span>pip install pathlib parse</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="kw">def</span> create_file_list(directory, filter_str<span class="op">=</span><span class="st">'*'</span>):</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  files <span class="op">=</span> Path(directory).glob(filter_str)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  files_to_analyze <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">str</span>, files))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="cf">return</span> files_to_analyze</span></code></pre>
</div>
<p>Alternatively, we can load this function from the
<code>helpers.py</code> file we provided for learners in this
course:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="im">from</span> helpers <span class="im">import</span> create_file_list</span></code></pre>
</div>
<p>Either way, now we can use that function to list the books in our
corpus:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>corpus_dir <span class="op">=</span> <span class="st">'/content/drive/My Drive/Colab Notebooks/text-analysis/data/books'</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>corpus_file_list <span class="op">=</span> create_file_list(corpus_dir)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="bu">print</span>(corpus_file_list)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>['/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-olivertwist.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-knewtoomuch.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-tenyearslater.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-twentyyearsafter.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-pride.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-taleoftwocities.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-whitehorse.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-hardtimes.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-emma.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-thursday.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-threemusketeers.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-ball.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-ladysusan.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-persuasion.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-conman.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-napoleon.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-brown.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-maninironmask.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-blacktulip.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-greatexpectations.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-ourmutualfriend.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-sense.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-christmascarol.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-davidcopperfield.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-pickwickpapers.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-bartleby.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-bleakhouse.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-montecristo.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-northanger.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-moby_dick.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-twelfthnight.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-typee.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-romeo.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-omoo.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-piazzatales.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-muchado.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-midsummer.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-lear.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-pierre.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-caesar.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-othello.txt']</span></code></pre>
</div>
<p>We will use the full corpus later, but it might be useful to filter
to just a few specific files. For example, if I want just documents
written by Austen, I can filter on part of the file path name:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>austen_list <span class="op">=</span> create_file_list(corpus_dir, <span class="st">'austen*'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="bu">print</span>(austen_list)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>['/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-pride.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-emma.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-ladysusan.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-persuasion.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-sense.txt', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-northanger.txt']</span></code></pre>
</div>
<p>Let’s take a closer look at Emma. We are looking at the first full
sentence, which begins with character 50 and ends at character 290.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>preview_len <span class="op">=</span> <span class="dv">290</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>emmapath <span class="op">=</span> create_file_list(corpus_dir, <span class="st">'austen-emma*'</span>)[<span class="dv">0</span>]</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="bu">print</span>(emmapath)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>sentence <span class="op">=</span> <span class="st">""</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(emmapath, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  sentence <span class="op">=</span> f.read(preview_len)[<span class="dv">50</span>:preview_len]</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="bu">print</span>(sentence)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-emma.txt</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>Emma Woodhouse, handsome, clever, and rich, with a comfortable home</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>and happy disposition, seemed to unite some of the best blessings</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>of existence; and had lived nearly twenty-one years in the world</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>with very little to distress or vex her.</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="preprocessing">Preprocessing<a class="anchor" aria-label="anchor" href="#preprocessing"></a></h2>
<hr class="half-width"><p>Currently, our data is still in a format that is best for humans to
read. Humans, without having to think too consciously about it,
understand how words and sentences group up and divide into discrete
units of meaning. We also understand that the words <em>run</em>,
<em>ran</em>, and <em>running</em> are just different grammatical forms
of the same underlying concept. Finally, not only do we understand how
punctuation affects the meaning of a text, we also can make sense of
texts that have odd amounts or odd placements of punctuation.</p>
<p>For example, Darcie Wilder’s <a href="https://www.mtv.com/news/1vw892/read-an-excerpt-of-darcie-wilders-literally-show-me-a-healthy-person" class="external-link"><em>literally
show me a healthy person</em></a> has very little capitalization or
punctuation:</p>
<blockquote>
<p>in the unauthorized biography of britney spears she says her advice
is to lift 1 lb weights and always sing in elevators every time i left
to skateboard in the schoolyard i would sing in the elevator i would
sing britney spears really loud and once the door opened and there were
so many people they heard everything so i never sang again</p>
</blockquote>
<p>Across the texts in our corpus, our authors write with different
styles, preferring different dictions, punctuation, and so on.</p>
<p>To prepare our data to be more uniformly understood by our NLP
models, we need to (a) break it into smaller units, (b) replace words
with their roots, and (c) remove unwanted common or unhelpful words and
punctuation. These steps encompass the preprocessing stage of the
interpretive loop.</p>
<figure><img src="../fig/01-Interpretive_Loop.JPG" alt="The Interpretive Loop" class="figure mx-auto d-block"></figure><div class="section level3">
<h3 id="tokenization">Tokenization<a class="anchor" aria-label="anchor" href="#tokenization"></a></h3>
<p>Tokenization is the process of breaking down texts (strings of
characters) into words, groups of words, and sentences. A string of
characters needs to be understood by a program as smaller units so that
it can be embedded. These are called <strong>tokens</strong>.</p>
<p>While our tokens will be single words for now, this will not always
be the case. Different models have different ways of tokenizing strings.
The strings may be broken down into multiple word tokens, single word
tokens, or even components of words like letters or morphology.
Punctuation may or may not be included.</p>
<p>We will be using a tokenizer that breaks documents into single words
for this lesson.</p>
<p>Let’s load our tokenizer and test it with the first sentence of
Emma:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="im">import</span> en_core_web_sm</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>spacyt <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span></code></pre>
</div>
<p>We will define a tokenizer method with the text editor. Keep this
open so we can add to it throughout the lesson.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="kw">class</span> Our_Tokenizer:</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="co">#import spacy tokenizer/language model</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="va">self</span>.nlp <span class="op">=</span> en_core_web_sm.load()</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="va">self</span>.nlp.max_length <span class="op">=</span> <span class="dv">4500000</span> <span class="co"># increase max number of characters that spacy can process (default = 1,000,000)</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, document):</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    tokens <span class="op">=</span> <span class="va">self</span>.nlp(document)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="cf">return</span> tokens</span></code></pre>
</div>
<p>This will load spacy and its preprocessing pipeline for English.
<strong>Pipelines</strong> are a series of interrelated tasks, where the
output of one task is used as an input for another. Different languages
may have different rulesets, and therefore require different
preprocessing pipelines. Running the document we created through the NLP
model we loaded performs a variety of tasks for us. Let’s look at these
in greater detail.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>tokens <span class="op">=</span> spacyt(sentence)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> tokens:</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a> <span class="bu">print</span>(t.text)</span></code></pre>
</div>
<pre class="text"><code>Emma
Woodhouse
,
handsome
,
clever
,
and
rich
,
with
a
comfortable
home


and
happy
disposition
,
seemed
to
unite
some
of
the
best
blessings


of
existence
;
and
had
lived
nearly
twenty
-
one
years
in
the
world


with
very
little
to
distress
or
vex
her
.</code></pre>
<p>The single sentence has been broken down into a set of tokens. Tokens
in spacy aren’t just strings: They’re python objects with a variety of
attributes. Full documentation for these attributes can be found at: <a href="https://spacy.io/api/token" class="external-link uri">https://spacy.io/api/token</a></p>
</div>
<div class="section level3">
<h3 id="stems-and-lemmas">Stems and Lemmas<a class="anchor" aria-label="anchor" href="#stems-and-lemmas"></a></h3>
<p>Think about similar words, such as <em>running</em>, <em>ran</em>,
and <em>runs</em>. All of these words have a similar root, but a
computer does not know this. Without preprocessing, each of these words
would be a new token.</p>
<p>Stemming and Lemmatization are used to group together words that are
similar or forms of the same word.</p>
<p>Stemming is removing the conjugation and pluralized endings for
words. For example, words like <em>digitization</em>, and
<em>digitizing</em> might chopped down to <em>digitiz</em>.</p>
<p>Lemmatization is the more sophisticated of the two, and looks for the
linguistic base of a word. Lemmatization can group words that mean the
same thing but may not be grouped through simple stemming, such as
irregular verbs like <em>bring</em> and <em>brought</em>.</p>
<p>Similarly, in naive tokenization, capital letters are considered
different from non-capital letters, meaning that capitalized versions of
words are considered different from non-capitalized versions. Converting
all words to lower case ensures that capitalized and non-capitalized
versions of words are considered the same.</p>
<p>These steps are taken to reduce the complexities of our NLP models
and to allow us to train them from less data.</p>
<p>When we tokenized the first sentence of Emma above, Spacy also
created a lemmatized version of itt. Let’s try accessing this by typing
the following:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> tokens:</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="bu">print</span>(t.lemma)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>14931068470291635495</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>17859265536816163747</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>2593208677638477497</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>7792995567492812500</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>2593208677638477497</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>5763234570816168059</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>2593208677638477497</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>2283656566040971221</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>10580761479554314246</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>2593208677638477497</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>12510949447758279278</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>11901859001352538922</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>2973437733319511985</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>12006852138382633966</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>962983613142996970</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>2283656566040971221</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>244022080605231780</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>3083117615156646091</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>2593208677638477497</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>15203660437495798636</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>3791531372978436496</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>1872149278863210280</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>7000492816108906599</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>886050111519832510</span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>7425985699627899538</span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>5711639017775284443</span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>451024245859800093</span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a>962983613142996970</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a>886050111519832510</span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>4708766880135230039</span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a>631425121691394544</span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a>2283656566040971221</span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a>14692702688101715474</span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a>13874798850131827181</span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a>16179521462386381682</span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a>8304598090389628520</span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a>9153284864653046197</span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a>17454115351911680600</span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a>14889849580704678361</span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a>3002984154512732771</span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a>7425985699627899538</span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a>1703489418272052182</span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a>962983613142996970</span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a>12510949447758279278</span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a>9548244504980166557</span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a>9778055143417507723</span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a>3791531372978436496</span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a>14526277127440575953</span>
<span id="cb17-49"><a href="#cb17-49" tabindex="-1"></a>3740602843040177340</span>
<span id="cb17-50"><a href="#cb17-50" tabindex="-1"></a>14980716871601793913</span>
<span id="cb17-51"><a href="#cb17-51" tabindex="-1"></a>6740321247510922449</span>
<span id="cb17-52"><a href="#cb17-52" tabindex="-1"></a>12646065887601541794</span>
<span id="cb17-53"><a href="#cb17-53" tabindex="-1"></a>962983613142996970</span></code></pre>
</div>
<p>Spacy stores words by an ID number, and not as a full string, to save
space in memory. Many spacy functions will return numbers and not words
as you might expect. Fortunately, adding an underscore for spacy will
return text representations instead. We will also add in the lower case
function so that all words are lower case.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> tokens:</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a> <span class="bu">print</span>(<span class="bu">str</span>.lower(t.lemma_))</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>emma</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>woodhouse</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>handsome</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>clever</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>and</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>rich</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>,</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>with</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>a</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>comfortable</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>home</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>and</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>happy</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>disposition</span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>,</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>seem</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>to</span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a>unite</span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>some</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>of</span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a>the</span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a>good</span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a>blessing</span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a>of</span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a>existence</span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a>;</span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a>and</span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a>have</span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a>live</span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a>nearly</span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a>twenty</span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a>-</span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a>one</span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a>year</span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a>in</span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a>the</span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a>world</span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a>with</span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a>very</span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a>little</span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a>to</span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a>distress</span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a>or</span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a>vex</span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a>she</span>
<span id="cb19-55"><a href="#cb19-55" tabindex="-1"></a>.</span></code></pre>
</div>
<p>Notice how words like <em>best</em> and <em>her</em> have been
changed to their root words like <em>good</em> and <em>she</em>. Let’s
change our tokenizer to save the lower cased, lemmatized versions of
words instead of the original words.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="kw">class</span> Our_Tokenizer:</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>    <span class="co"># import spacy tokenizer/language model</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    <span class="va">self</span>.nlp <span class="op">=</span> en_core_web_sm.load()</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>    <span class="va">self</span>.nlp.max_length <span class="op">=</span> <span class="dv">4500000</span> <span class="co"># increase max number of characters that spacy can process (default = 1,000,000)</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, document):</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    tokens <span class="op">=</span> <span class="va">self</span>.nlp(document)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    simplified_tokens <span class="op">=</span> [<span class="bu">str</span>.lower(token.lemma_) <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    <span class="cf">return</span> simplified_tokens</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="stop-words-and-punctuation">Stop-Words and Punctuation<a class="anchor" aria-label="anchor" href="#stop-words-and-punctuation"></a></h3>
<p>Stop-words are common words that are often filtered out for more
efficient natural language data processing. Words such as <em>the</em>
and <em>and</em> don’t necessarily tell us a lot about a document’s
content and are often removed in simpler models. Stop lists (groups of
stop words) are curated by sorting terms by their collection frequency,
or the total number of times that they appear in a document or corpus.
Punctuation also is something we are not interested in, at least not
until we get to more complex models. Many open-source software packages
for language processing, such as Spacy, include stop lists. Let’s look
at Spacy’s stopword list.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="im">from</span> spacy.lang.en.stop_words <span class="im">import</span> STOP_WORDS</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="bu">print</span>(STOP_WORDS)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>{''s', 'must', 'again', 'had', 'much', 'a', 'becomes', 'mostly', 'once', 'should', 'anyway', 'call', 'front', 'whence', ''ll', 'whereas', 'therein', 'himself', 'within', 'ourselves', 'than', 'they', 'toward', 'latterly', 'may', 'what', 'her', 'nowhere', 'so', 'whenever', 'herself', 'other', 'get', 'become', 'namely', 'done', 'could', 'although', 'which', 'fifteen', 'seems', 'hereafter', 'whereafter', 'two', "'ve", 'to', 'his', 'one', ''d', 'forty', 'being', 'i', 'four', 'whoever', 'somehow', 'indeed', 'that', 'afterwards', 'us', 'she', "'d", 'herein', ''ll', 'keep', 'latter', 'onto', 'just', 'too', "'m", ''re', 'you', 'no', 'thereby', 'various', 'enough', 'go', 'myself', 'first', 'seemed', 'up', 'until', 'yourselves', 'while', 'ours', 'can', 'am', 'throughout', 'hereupon', 'whereupon', 'somewhere', 'fifty', 'those', 'quite', 'together', 'wherein', 'because', 'itself', 'hundred', 'neither', 'give', 'alone', 'them', 'nor', 'as', 'hers', 'into', 'is', 'several', 'thus', 'whom', 'why', 'over', 'thence', 'doing', 'own', 'amongst', 'thereupon', 'otherwise', 'sometime', 'for', 'full', 'anyhow', 'nine', 'even', 'never', 'your', 'who', 'others', 'whole', 'hereby', 'ever', 'or', 'and', 'side', 'though', 'except', 'him', 'now', 'mine', 'none', 'sixty', "n't", 'nobody', ''m', 'well', "'s", 'then', 'part', 'someone', 'me', 'six', 'less', 'however', 'make', 'upon', ''s', ''re', 'back', 'did', 'during', 'when', ''d', 'perhaps', "'re", 'we', 'hence', 'any', 'our', 'cannot', 'moreover', 'along', 'whither', 'by', 'such', 'via', 'against', 'the', 'most', 'but', 'often', 'where', 'each', 'further', 'whereby', 'ca', 'here', 'he', 'regarding', 'every', 'always', 'are', 'anywhere', 'wherever', 'using', 'there', 'anyone', 'been', 'would', 'with', 'name', 'some', 'might', 'yours', 'becoming', 'seeming', 'former', 'only', 'it', 'became', 'since', 'also', 'beside', 'their', 'else', 'around', 're', 'five', 'an', 'anything', 'please', 'elsewhere', 'themselves', 'everyone', 'next', 'will', 'yourself', 'twelve', 'few', 'behind', 'nothing', 'seem', 'bottom', 'both', 'say', 'out', 'take', 'all', 'used', 'therefore', 'below', 'almost', 'towards', 'many', 'sometimes', 'put', 'were', 'ten', 'of', 'last', 'its', 'under', 'nevertheless', 'whatever', 'something', 'off', 'does', 'top', 'meanwhile', 'how', 'already', 'per', 'beyond', 'everything', 'not', 'thereafter', 'eleven', 'n't', 'above', 'eight', 'before', 'noone', 'besides', 'twenty', 'do', 'everywhere', 'due', 'empty', 'least', 'between', 'down', 'either', 'across', 'see', 'three', 'on', 'formerly', 'be', 'very', 'rather', 'made', 'has', 'this', 'move', 'beforehand', 'if', 'my', 'n't', "'ll", 'third', 'without', ''m', 'yet', 'after', 'still', 'same', 'show', 'in', 'more', 'unless', 'from', 'really', 'whether', ''ve', 'serious', 'these', 'was', 'amount', 'whose', 'have', 'through', 'thru', ''ve', 'about', 'among', 'another', 'at'}</span></code></pre>
</div>
<p>It’s possible to add and remove words as well, for example,
<em>zebra</em>:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># remember, we need to tokenize things in order for our model to analyze them.</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>z <span class="op">=</span> spacyt(<span class="st">"zebra"</span>)[<span class="dv">0</span>]</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="bu">print</span>(z.is_stop) <span class="co"># False</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co"># add zebra to our stopword list</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>STOP_WORDS.add(<span class="st">"zebra"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>spacyt <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>z <span class="op">=</span> spacyt(<span class="st">"zebra"</span>)[<span class="dv">0</span>]</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="bu">print</span>(z.is_stop) <span class="co"># True</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co"># remove zebra from our list.</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>STOP_WORDS.remove(<span class="st">"zebra"</span>)</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>spacyt <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>z <span class="op">=</span> spacyt(<span class="st">"zebra"</span>)[<span class="dv">0</span>]</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="bu">print</span>(z.is_stop) <span class="co"># False</span></span></code></pre>
</div>
<p>Let’s add “Emma” to our list of stopwords, since knowing that the
name “Emma” is often in Jane Austin does not tell us anything
interesting.</p>
<p>This will only adjust the stopwords for the current session, but it
is possible to save them if desired. More information about how to do
this can be found in the Spacy documentation. You might use this
stopword list to filter words from documents using spacy, or just by
manually iterating through it like a list.</p>
<p>Let’s see what our example looks like without stopwords and
punctuation:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># add emma to our stopword list</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>STOP_WORDS.add(<span class="st">"emma"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>spacyt <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co"># retokenize our sentence</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>tokens <span class="op">=</span> spacyt(sentence)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="cf">for</span> token <span class="kw">in</span> tokens:</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  <span class="cf">if</span> <span class="kw">not</span> token.is_stop <span class="kw">and</span> <span class="kw">not</span> token.is_punct:</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">str</span>.lower(token.lemma_))</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>woodhouse</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>handsome</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>clever</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>rich</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>comfortable</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>home</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>happy</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>disposition</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>unite</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>good</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>blessing</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>existence</span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>live</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>nearly</span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>year</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>world</span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a>little</span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a>distress</span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a>vex</span></code></pre>
</div>
<p>Notice that because we added <em>emma</em> to our stopwords, she is
not in our preprocessed sentence any more. Other stopwords are also
missing such as numbers.</p>
<p>Let’s filter out stopwords and punctuation from our custom tokenizer
now as well:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="kw">class</span> Our_Tokenizer:</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>    <span class="co"># import spacy tokenizer/language model</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>    <span class="va">self</span>.nlp <span class="op">=</span> en_core_web_sm.load()</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    <span class="va">self</span>.nlp.max_length <span class="op">=</span> <span class="dv">4500000</span> <span class="co"># increase max number of characters that spacy can process (default = 1,000,000)</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, document):</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    tokens <span class="op">=</span> <span class="va">self</span>.nlp(document)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>    simplified_tokens <span class="op">=</span> []    </span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>    <span class="cf">for</span> token <span class="kw">in</span> tokens:</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> token.is_stop <span class="kw">and</span> <span class="kw">not</span> token.is_punct:</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>            simplified_tokens.append(<span class="bu">str</span>.lower(token.lemma_))</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>    <span class="cf">return</span> simplified_tokens</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="parts-of-speech">Parts of Speech<a class="anchor" aria-label="anchor" href="#parts-of-speech"></a></h3>
<p>While we can manually add Emma to our stopword list, it may occur to
you that novels are filled with characters with unique and unpredictable
names. We’ve already missed the word “Woodhouse” from our list. Creating
an enumerated list of all of the possible character names seems
impossible.</p>
<p>One way we might address this problem is by using <strong>Parts of
speech (POS)</strong> tagging. POS are things such as nouns, verbs, and
adjectives. POS tags often prove useful, so some tokenizers also have
built in POS tagging done. Spacy is one such library. These tags are not
100% accurate, but they are a great place to start. Spacy’s POS tags can
be used by accessing the <code>pos_</code> method for each token.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="cf">for</span> token <span class="kw">in</span> tokens:</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="cf">if</span> token.is_stop <span class="op">==</span> <span class="va">False</span> <span class="kw">and</span> token.is_punct <span class="op">==</span> <span class="va">False</span>:</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">str</span>.lower(token.lemma_)<span class="op">+</span><span class="st">" "</span><span class="op">+</span>token.pos_)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>woodhouse PROPN</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>handsome ADJ</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>clever ADJ</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>rich ADJ</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>comfortable ADJ</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>home NOUN</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  SPACE</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>happy ADJ</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>disposition NOUN</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>unite VERB</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>good ADJ</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>blessing NOUN</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>  SPACE</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>existence NOUN</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>live VERB</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>nearly ADV</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>year NOUN</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>world NOUN</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>  SPACE</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>little ADJ</span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>distress VERB</span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>vex VERB</span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a></span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a>  SPACE</span></code></pre>
</div>
<p>Because our dataset is relatively small, we may find that character
names and places weigh very heavily in our early models. We also have a
number of blank or white space tokens, which we will also want to
remove.</p>
<p>We will finish our special tokenizer by removing punctuation and
proper nouns from our documents:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="kw">class</span> Our_Tokenizer:</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>    <span class="co"># import spacy tokenizer/language model</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>    <span class="va">self</span>.nlp <span class="op">=</span> en_core_web_sm.load()</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>    <span class="va">self</span>.nlp.max_length <span class="op">=</span> <span class="dv">4500000</span> <span class="co"># increase max number of characters that spacy can process (default = 1,000,000)</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, document):</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>    tokens <span class="op">=</span> <span class="va">self</span>.nlp(document)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>    simplified_tokens <span class="op">=</span> [</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>      <span class="co">#our helper function expects spacy tokens. It will take care of making them lowercase lemmas.</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>      token <span class="cf">for</span> token <span class="kw">in</span> tokens</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>      <span class="cf">if</span> <span class="kw">not</span> token.is_stop</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>      <span class="kw">and</span> <span class="kw">not</span> token.is_punct</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>      <span class="kw">and</span> token.pos_ <span class="op">!=</span> <span class="st">"PROPN"</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>    ]</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>    <span class="cf">return</span> simplified_tokens</span></code></pre>
</div>
<p>Alternative, instead of “blacklisting” all of the parts of speech we
don’t want to include, we can “whitelist” just the few that we want,
based on what they information they might contribute to the meaning of a
text:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="kw">class</span> Our_Tokenizer:</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>    <span class="co"># import spacy tokenizer/language model</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>    <span class="va">self</span>.nlp <span class="op">=</span> en_core_web_sm.load()</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>    <span class="va">self</span>.nlp.max_length <span class="op">=</span> <span class="dv">4500000</span> <span class="co"># increase max number of characters that spacy can process (default = 1,000,000)</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, document):</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>    tokens <span class="op">=</span> <span class="va">self</span>.nlp(document)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>    simplified_tokens <span class="op">=</span> [</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>      <span class="co">#our helper function expects spacy tokens. It will take care of making them lowercase lemmas.</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>      token <span class="cf">for</span> token <span class="kw">in</span> tokens</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>      <span class="cf">if</span> <span class="kw">not</span> token.is_stop</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>      <span class="kw">and</span> <span class="kw">not</span> token.is_punct</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>      <span class="kw">and</span> token.pos_ <span class="kw">in</span> {<span class="st">"ADJ"</span>, <span class="st">"ADV"</span>, <span class="st">"INTJ"</span>, <span class="st">"NOUN"</span>, <span class="st">"VERB"</span>}</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>    ]</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>    <span class="cf">return</span> simplified_tokens</span></code></pre>
</div>
<p>Either way, let’s test our custom tokenizer on this selection of text
to see how it works.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>tokenizer <span class="op">=</span> Our_Tokenizer()</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>tokens <span class="op">=</span> tokenizer(sentence)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="bu">print</span>(tokens)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>['handsome', 'clever', 'rich', 'comfortable', 'home', 'happy', 'disposition', 'unite', 'good', 'blessing', 'existence', 'live', 'nearly', 'year', 'world', 'little', 'distress', 'vex']</span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="putting-it-all-together">Putting it All Together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a></h2>
<hr class="half-width"><p>Now that we’ve built a tokenizer we’re happy with, lets use it to
create lemmatized versions of all the books in our corpus.</p>
<p>That is, we want to turn this:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>Emma Woodhouse, handsome, clever, and rich, with a comfortable home</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>and happy disposition, seemed to unite some of the best blessings</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>of existence; and had lived nearly twenty-one years in the world</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>with very little to distress or vex her.</span></code></pre>
</div>
<p>into this:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>handsome</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>clever</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>rich</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>comfortable</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>home</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>happy</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>disposition</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>seem</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>unite</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>good</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>blessing</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>existence</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>live</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>nearly</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>year</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>world</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>very</span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>little</span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>distress</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>vex</span></code></pre>
</div>
<p>To help make this quick for all the text in all our books, we’ll use
a helper function we prepared for learners to use our tokenizer, do the
casing and lemmatization we discussed earlier, and write the results to
a file:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="im">from</span> helpers <span class="im">import</span> lemmatize_files</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>lemma_file_list <span class="op">=</span> lemmatize_files(tokenizer, corpus_file_list)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">TXT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode txt" tabindex="0"><code class="sourceCode default"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>['/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-olivertwist.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-knewtoomuch.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-tenyearslater.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-twentyyearsafter.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-pride.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-taleoftwocities.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-whitehorse.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-hardtimes.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-emma.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-thursday.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-threemusketeers.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-ball.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-ladysusan.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-persuasion.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-conman.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-napoleon.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/chesterton-brown.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-maninironmask.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-blacktulip.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-greatexpectations.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-ourmutualfriend.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-sense.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-christmascarol.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-davidcopperfield.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-pickwickpapers.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-bartleby.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dickens-bleakhouse.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/dumas-montecristo.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/austen-northanger.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-moby_dick.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-twelfthnight.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-typee.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-romeo.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-omoo.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-piazzatales.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-muchado.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-midsummer.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-lear.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/melville-pierre.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-caesar.txt.lemmas', '/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/shakespeare-othello.txt.lemmas']</span></code></pre>
</div>
<p>This process may take several minutes to run. Doing this
preprocessing now however will save us much, much time later.</p>
</section><section><h2 class="section-heading" id="saving-our-progress">Saving Our Progress<a class="anchor" aria-label="anchor" href="#saving-our-progress"></a></h2>
<hr class="half-width"><p>Let’s save our progress by storing a spreadsheet (<code>*.csv</code>
or <code>*.xlsx</code> file) that lists all our authors, books, and
associated filenames, both the original and lemmatized copies.</p>
<p>We’ll use another helper we prepared to make this easy:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="im">from</span> helpers <span class="im">import</span> parse_into_dataframe</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>pattern <span class="op">=</span> <span class="st">"/content/drive/My Drive/Colab Notebooks/text-analysis/data/books/</span><span class="sc">{author}</span><span class="st">-</span><span class="sc">{title}</span><span class="st">.txt"</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>data <span class="op">=</span> parse_into_dataframe(pattern, corpus_file_list)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>data[<span class="st">"Lemma_File"</span>] <span class="op">=</span> lemma_file_list</span></code></pre>
</div>
<p>Finally, we’ll save this table to a file:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>data.to_csv(<span class="st">"/content/drive/My Drive/Colab Notebooks/text-analysis/data/data.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="outro-and-conclusion">Outro and Conclusion<a class="anchor" aria-label="anchor" href="#outro-and-conclusion"></a></h2>
<hr class="half-width"><p>This lesson has covered a number of preprocessing steps. We created a
list of our files in our corpus, which we can use in future lessons. We
customized a tokenizer from Spacy, to better suit the needs of our
corpus, which we can also use moving forward.</p>
<p>Next lesson, we will start talking about the concepts behind our
model.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Tokenization breaks strings into smaller parts for analysis.</li>
<li>Casing removes capital letters.</li>
<li>Stopwords are common words that do not contain much useful
information.</li>
<li>Lemmatization reduces words to their root form.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-apis.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-vectorSpace.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-apis.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Corpus Development-
        </a>
        <a class="chapter-link float-end" href="../instructor/04-vectorSpace.html" rel="next">
          Next: Vector Space and...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/josenino95/python-text-analysis/edit/main/episodes/03-preprocessing.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/josenino95/python-text-analysis/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/josenino95/python-text-analysis/" class="external-link">Source</a></p>
				<p><a href="https://github.com/josenino95/python-text-analysis/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://josenino95.github.io/python-text-analysis/instructor/03-preprocessing.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Preparing and Preprocessing Your Data",
  "creativeWorkStatus": "active",
  "url": "https://josenino95.github.io/python-text-analysis/instructor/03-preprocessing.html",
  "identifier": "https://josenino95.github.io/python-text-analysis/instructor/03-preprocessing.html",
  "dateCreated": "2020-10-12",
  "dateModified": "2025-03-21",
  "datePublished": "2025-04-29"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

